2초 동안 생각함

아래는 스크린샷 개선(폰트 로드 대기, `devicePixelRatio` 반영)과 방금 적용한 달 네비게이션·Today 버튼·한마디 노트·Notes 서브페이지 기능을 모두 포함한 전체 코드야.

```html
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>𝐝 : ᴛᴏᴅᴏ</title>
  <link rel="icon" href="./favi.ico" type="image/x-icon" />
  <style>
    @font-face { font-family: 'HJSS'; src: url('./HJSS.ttf') format('truetype'); }
    body { margin: 0; padding: 0; font-family: 'HJSS', sans-serif; background: #f5f5f5; box-sizing: border-box; }
    *, *::before, *::after { box-sizing: inherit; }
    .edit-delete-btn { font-size: 0.75rem; color: #888; background: none; border: none; cursor: pointer; margin-left: 0.5rem; }
    .sidebar-nav { padding: 1rem; text-align: center; }
    .sidebar-controls { display: flex; justify-content: center; gap: 0.5rem; margin: 1.5rem 0; }
    .sidebar-controls button { background: #f0f0f0; border: none; padding: 0.5rem; border-radius: 0.25rem; cursor: pointer; }
    .main-container { max-width: 42rem; margin: 0 auto; background: #fff; border-radius: 0.5rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1); padding: 1.5rem; }
    .note-input { width: 100%; border: 1px solid #ccc; padding: 0.5rem; border-radius: 0.25rem; resize: vertical; margin-bottom: 1rem; }
    .notes-list { display: flex; flex-direction: column; gap: 1rem; }
    .note-card { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-radius: 0.25rem; background: #fafafa; }
    .note-color { width: 1rem; height: 1rem; border-radius: 0.25rem; }
    .back-btn { margin-bottom: 1rem; background: #f0f0f0; border: none; padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer; }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React, Babel, Firebase, html2canvas -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-database-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <script type="text/babel">
    const firebaseConfig = {
      apiKey: "AIzaSyAa-8IWlzzPflkV6Iqzunha5TCnMXclTns",
      authDomain: "nagi-todo.firebaseapp.com",
      databaseURL: "https://nagi-todo-default-rtdb.firebaseio.com/",
      projectId: "nagi-todo",
      storageBucket: "nagi-todo.firebasestorage.app",
      messagingSenderId: "923414063910",
      appId: "1:923414063910:web:e09c59bc3cc72a19686fe7"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    function App() {
      const [text, setText] = React.useState('');
      const [categoryText, setCategoryText] = React.useState('');
      const [noteText, setNoteText] = React.useState('');
      const [allTodos, setAllTodos] = React.useState({});
      const [allNotes, setAllNotes] = React.useState({});
      const [selectedDate, setSelectedDate] = React.useState(new Date());
      const [showSidebar, setShowSidebar] = React.useState(true);
      const [view, setView] = React.useState('todo');
      const [accentColor, setAccentColor] = React.useState('#888888');
      const [dateColors, setDateColors] = React.useState({});
      const [editMode, setEditMode] = React.useState(false);
      const [draggedItem, setDraggedItem] = React.useState(null);
      const [draggedOverItem, setDraggedOverItem] = React.useState(null);
      const bulletStates = ['☐','☑','☒'];
      const dateKey = selectedDate.toLocaleDateString('en-CA');
      const items = allTodos[dateKey] || [];

      // 구독: todos
      React.useEffect(() => {
        const ref = database.ref('todos/'+dateKey);
        const cb = ref.on('value', snap => {
          setAllTodos(prev => ({ ...prev, [dateKey]: snap.exists()?snap.val():[] }));
        });
        return () => ref.off('value', cb);
      }, [dateKey]);

      // 구독: notes per day
      React.useEffect(() => {
        const ref = database.ref('notes/'+dateKey);
        const cb = ref.on('value', snap => {
          setNoteText(snap.exists()?snap.val():'');
        });
        return () => ref.off('value', cb);
      }, [dateKey]);

      // 구독: all notes
      React.useEffect(() => {
        const ref = database.ref('notes');
        const cb = ref.on('value', snap => {
          setAllNotes(snap.exists()?snap.val():{});
        });
        return () => ref.off('value', cb);
      }, []);

      // 구독: dateColors
      React.useEffect(() => {
        const ref = database.ref('dateColors');
        const cb = ref.on('value', snap => {
          setDateColors(snap.exists()?snap.val():{});
        });
        return () => ref.off('value', cb);
      }, []);

      function handleNoteChange(e) {
        const val = e.target.value;
        setNoteText(val);
        database.ref('notes/'+dateKey).set(val);
      }

      async function exportAsImage() {
        await document.fonts.ready;
        const container = document.getElementById('export-container');
        const canvas = await html2canvas(container, {
          scale: window.devicePixelRatio,
          useCORS: true,
          allowTaint: true,
          backgroundColor: '#fff'
        });
        canvas.toBlob(async blob => {
          const perm = await navigator.permissions.query({ name:'clipboard-write' });
          if (perm.state==='granted'||perm.state==='prompt') {
            await navigator.clipboard.write([new ClipboardItem({'image/png':blob})]);
            alert('클립보드에 복사되었어.');
          } else {
            alert('클립보드 권한이 필요해.');
          }
        });
      }

      function goToday() {
        setSelectedDate(new Date());
        setView('todo');
      }

      // 할 일 추가
      function handleKeyDownTodo(e) {
        if (e.key==='Enter' && !e.shiftKey) {
          e.preventDefault();
          if (text.trim()) {
            database.ref('todos/'+dateKey).once('value').then(snap => {
              const list = snap.exists()?snap.val():[];
              list.push({ type:'todo', text:text.trim(), state:0 });
              database.ref('todos/'+dateKey).set(list);
            });
            setText('');
          }
        }
      }
      function handleKeyDownCategory(e) {
        if (e.key==='Enter') {
          e.preventDefault();
          if (categoryText.trim()) {
            database.ref('todos/'+dateKey).once('value').then(snap => {
              const list = snap.exists()?snap.val():[];
              list.push({ type:'category', text:categoryText.trim() });
              database.ref('todos/'+dateKey).set(list);
            });
            setCategoryText('');
          }
        }
      }
      function addDivider() {
        database.ref('todos/'+dateKey).once('value').then(snap => {
          const list = snap.exists()?snap.val():[];
          list.push({ type:'divider' });
          database.ref('todos/'+dateKey).set(list);
        });
      }
      function toggleState(i) {
        if (editMode) return;
        database.ref('todos/'+dateKey).once('value').then(snap => {
          const list = snap.exists()?snap.val():[];
          if (list[i].type==='todo') list[i].state = (list[i].state+1)%bulletStates.length;
          database.ref('todos/'+dateKey).set(list);
        });
      }
      function deleteItem(i) {
        database.ref('todos/'+dateKey).once('value').then(snap => {
          const list = snap.exists()?snap.val():[];
          list.splice(i,1);
          database.ref('todos/'+dateKey).set(list);
        });
      }
      function editItem(i) {
        database.ref('todos/'+dateKey).once('value').then(snap => {
          const list = snap.exists()?snap.val():[];
          const txt = prompt('Edit text:', list[i].text);
          if (txt!=null && txt.trim()) {
            list[i].text = txt.trim();
            database.ref('todos/'+dateKey).set(list);
          }
        });
      }

      // DnD (editMode)
      function handleDragStart(e,i) {
        if (!editMode) return;
        setDraggedItem(i);
        e.currentTarget.style.opacity='0.4';
      }
      function handleDragEnd(e) {
        if (!editMode) return;
        e.currentTarget.style.opacity='1';
        setDraggedItem(null);
        setDraggedOverItem(null);
      }
      function handleDragOver(e,i) {
        if (!editMode) return;
        e.preventDefault();
        setDraggedOverItem(i);
      }
      function handleDrop(e,i) {
        if (!editMode) return;
        e.preventDefault();
        database.ref('todos/'+dateKey).once('value').then(snap => {
          const list = snap.exists()?snap.val():[];
          const dragged = list.splice(draggedItem,1)[0];
          list.splice(i,0,dragged);
          database.ref('todos/'+dateKey).set(list);
        });
        setDraggedItem(null);
        setDraggedOverItem(null);
      }

      return (
        <div style={{minHeight:'100vh',display:'flex'}}>
          <button onClick={()=>setShowSidebar(!showSidebar)} style={{position:'fixed',left:'1rem',top:'1rem',zIndex:10,background:'#fff',padding:'0.5rem',borderRadius:'9999px',boxShadow:'0 2px 5px rgba(0,0,0,0.1)',cursor:'pointer'}}>
            {showSidebar?'←':'→'}
          </button>
          <div style={{position:'fixed',left:0,top:0,bottom:0,width:'16rem',background:'#fff',boxShadow:'0 2px 5px rgba(0,0,0,0.1)',zIndex:20,transform:showSidebar?'translateX(0)':'translateX(-100%)',transition:'transform 0.3s'}}>
            <div className="sidebar-nav">
              <h2>{selectedDate.getFullYear()}<br/>{selectedDate.toLocaleString('en-US',{month:'long'})}</h2>
            </div>
            <div style={{padding:'0 1rem'}}>
              <div style={{display:'grid',gridTemplateColumns:'repeat(7,1fr)',gap:'0.25rem',fontSize:'0.875rem',color:'#666'}}>
                {['S','M','T','W','T','F','S'].map(d=> <div key={d} style={{textAlign:'center',fontWeight:'500'}}>{d}</div> )}
                {Array(new Date(selectedDate.getFullYear(),selectedDate.getMonth(),1).getDay()).fill().map((_,i)=> <div key={i}/> )}
                {Array.from({length:new Date(selectedDate.getFullYear(),selectedDate.getMonth()+1,0).getDate()},(_,i)=>{
                  const d=new Date(selectedDate.getFullYear(),selectedDate.getMonth(),i+1);
                  const key=d.toLocaleDateString('en-CA');
                  const isSel=key===dateKey;
                  const color=dateColors[key]||accentColor;
                  return <button key={i} onClick={()=>{setSelectedDate(d);if(window.innerWidth<768)setShowSidebar(false);}} style={{width:'1.8rem',height:'1.8rem',margin:'0 auto',display:'flex',alignItems:'center',justifyContent:'center',borderRadius:'9999px',background:isSel?color:'transparent',color:isSel?'#fff':'#000',cursor:'pointer'}}>
                    <span>{i+1}</span>
                  </button>;
                })}
              </div>
              <div className="sidebar-controls">
                <button onClick={()=>setSelectedDate(d=>new Date(d.getFullYear(),d.getMonth()-1,1))}>←</button>
                <button onClick={goToday}>Today</button>
                <button onClick={()=>setSelectedDate(d=>new Date(d.getFullYear(),d.getMonth()+1,1))}>→</button>
              </div>
              <div style={{textAlign:'center'}}><button className="sidebar-controls" onClick={()=>setView('notes')}>Notes</button></div>
            </div>
          </div>
          <div style={{flex:1,padding:'1rem',marginLeft:showSidebar?'16rem':'0',transition:'margin-left 0.3s'}}>
            {view==='todo' ? (
              <div id="export-container" className="main-container">
                <h2 style={{fontSize:'1.25rem',fontWeight:'bold',marginBottom:'1rem'}}>
                  {selectedDate.toLocaleDateString('en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric'})}
                </h2>
                <textarea className="note-input" value={noteText} onChange={handleNoteChange} placeholder="오늘의 한 마디..." rows={2}/>
                <textarea value={text} onChange={e=>setText(e.target.value)} onKeyDown={handleKeyDownTodo} placeholder="Add a task (Enter to save, Shift+Enter for newline)" rows={3} style={{width:'100%',border:'1px solid #ccc',padding:'0.5rem',borderRadius:'0.25rem',resize:'vertical',marginBottom:'1rem'}}/>
                <div style={{display:'grid',gridTemplateColumns:'auto 1fr',gap:'0.5rem',marginBottom:'1rem'}}>
                  <button onClick={addDivider} style={{padding:'0.5rem',border:'none',background:'#f0f0f0',borderRadius:'0.25rem',cursor:'pointer'}}>Add Divider</button>
                  <input type="text" value={categoryText} onChange={e=>setCategoryText(e.target.value)} onKeyDown={handleKeyDownCategory} placeholder="Add category..." style={{border:'1px solid #ccc',padding:'0.5rem',borderRadius:'0.25rem'}}/>
                </div>
                <div style={{display:'flex',flexDirection:'column',gap:'0.5rem'}}>
                  {items.map((item,i)=> {
                    const dndProps = editMode ? { draggable:true, onDragStart:e=>handleDragStart(e,i), onDragOver:e=>handleDragOver(e,i), onDrop:e=>handleDrop(e,i), onDragEnd:handleDragEnd } : {};
                    if(item.type==='divider') return <hr key={i} style={{borderTop:'1px solid '+accentColor,margin:'0.5rem 0'}} {...dndProps}/>;
                    if(item.type==='category') return <div key={i} {...dndProps} style={{fontWeight:'600',color:'#555',padding:'0.5rem'}}>{item.text}</div>;
                    return <div key={i} {...dndProps} style={{display:'flex',alignItems:'center',gap:'0.5rem',padding:'0.5rem',borderRadius:'0.25rem',background:'#fafafa',cursor:editMode?'move':'pointer'}} onClick={()=>toggleState(i)}>
                      <span style={{fontFamily:'monospace',fontSize:'1.25rem',color:accentColor}}>{bulletStates[item.state]}</span>
                      <span style={{flex:1,whiteSpace:'pre-wrap'}}>{item.text}</span>
                      {editMode && <>
                        <button className="edit-delete-btn" onClick={()=>editItem(i)}>Edit</button>
                        <button className="edit-delete-btn" onClick={()=>deleteItem(i)}>Delete</button>
                      </>}
                    </div>;
                  })}
                </div>
                {items.length>0 && <button onClick={exportAsImage} style={{marginTop:'1rem',padding:'0.5rem',background:accentColor,color:'#fff',border:'none',borderRadius:'0.25rem',cursor:'pointer'}}>Export as Image</button>}
                <button onClick={()=>setEditMode(m=>!m)} style={{marginTop:'0.5rem',padding:'0.5rem',background:editMode?'#ddd':'#f0f0f0',border:'none',borderRadius:'0.25rem',cursor:'pointer'}}>{editMode?'Done':'Edit'}</button>
              </div>
            ) : (
              <div className="main-container">
                <button className="back-btn" onClick={()=>setView('todo')}>Back</button>
                <div className="notes-list">
                  {Object.entries(allNotes).sort((a,b)=>b[0].localeCompare(a[0])).map(([k,n])=>{
                    const d=new Date(k);
                    const color=dateColors[k]||accentColor;
                    return <div key={k} className="note-card">
                      <div className="note-color" style={{background:color}}/>
                      <div><strong>{d.toLocaleDateString('en-US',{year:'numeric',month:'numeric',day:'numeric',weekday:'short'})}</strong></div>
                      <div>{n}</div>
                    </div>;
                  })}
                </div>
              </div>
            )}
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
```
